/**
 * @fileoverview Main entry point for the BitLine website.
 */

import { translations } from './translations.js';
import { TypingEffect } from './typing.js';
import { LanguageManager } from './language.js';

/**
 * Throttles a function to limit execution frequency.
 * @param {Function} func - The function to throttle.
 * @param {number} limit - Time limit in ms.
 * @returns {Function} Throttled function.
 */
function throttle(func, limit) {
  let inThrottle;
  return function(...args) {
    if (!inThrottle) {
      func.apply(this, args);
      inThrottle = true;
      setTimeout(() => inThrottle = false, limit);
    }
  };
}

document.addEventListener("DOMContentLoaded", () => {
  try {
    // Initialize typing effect
    const typingEffect = new TypingEffect("typing-text", translations.get('en').typingTexts);
    typingEffect.start();

    // Initialize language manager
    const langManager = new LanguageManager("lang-btn");
    langManager.setTypingEffect(typingEffect);

    // Throttled scroll event for header effect
    const header = document.querySelector("header");
    if (header) {
      const throttledScroll = throttle(() => {
        header.classList.toggle("scrolled", window.scrollY > 50);
      }, 100);
      window.addEventListener("scroll", throttledScroll);
    }

    console.log("BitLine website initialized successfully.");
  } catch (error) {
    console.error("Error initializing BitLine website:", error);
    // Optional: Show user-friendly error message
    alert("An error occurred while loading the page. Please refresh.");
  }
});
